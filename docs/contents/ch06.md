# 第6章 工业界前沿技术应用

## 1 强化学习

1. 特点：
   - 试错学习
   - 延迟反馈
   - 时间是一个重要因素
   - 当前的行为影响后续接收到的数据

2. 基本组成要素
    - agent（智能体）
    - environment（环境）
    - state（状态）
    - action（动作）
    - reward（奖励）

3. 训练过程：整个训练过程符合马尔可夫决策过程，核心思想是下一步的`state`只和当前的`state`以及要采取的`action`有关，只回溯一步。

### 1.1 基于价值的强化学习

#### 1.1.1 基于价值的算法

- 说明：基于每个`state`下可以采取的所有`action`，以及这些`action`对应的`value`，来选择当前`state`如何行动。
- 代表性算法：Q-Learning、SARSA
- 探索与利用：在强化学习训练的时候，一开始会让`agent`偏向于探索（explore），等到训练多轮之后，尝试了在各种`state`下选择各种`action`，大幅降低探索比例，尽量让`agent`偏向于利用（exploit），选择`value`最大的`action`。

#### 1.1.2 Q-Learning算法

**基本概念：**
- Q-Table：`action`和`value`的键值字典。
- Bellman方程的思想：当在特定时间点和状态下去考虑下一步的决策，不仅要关注当前决策立即产生的reward，也要考虑当前决策衍生的持续性reward。
- Bellman方程：
$$
Q(s,a) \leftarrow Q(s, a) + \alpha [\text{reward} + \gamma \text{Max}_{\alpha'} Q(s', a') - Q(s, a)]
$$
其中
  - $Q(s,a)$表示状态$s$，采取了动作$a$，得到的`value`值。
  - $Q(s', a')$表示状态$s'$，采取了动作$a'$，得到的`value`值。
  - `reward`表示在状态$s$变为状态$s$，环境立即给予的`reward`反馈。
  - $\text{Max}_{\alpha'} Q(s', a')$表示在状态$s'$下，可以采取的所有动作中$a'$，能够得到的最大`value`值。
  - $\alpha$是学习率，$\gamma$是折扣率。

### 1.2 强化学习实际开展的难点

- `reward`设置：无法将环境的反馈量化。
- 采样训练耗时过长，工业实际应用难。
- 容易导致局部最优。

## 2 联邦学习

### 2.1 联邦学习概述

- 定义（来源于《联邦学习白皮书》）：在进行机器学习过程中，各参与方可借助其他方数据进行联合建模。各方无须共享数据资源，即在数据不出本地的情况下，进行联合训练，建立共享的机器学习模型。
- 分类：
  - 横向联邦学习：适用于两个场景下用户的特征重合度高，但用户重合度很低的情况。
  - 纵向联邦学习：适用于两个场景下用户的特征重合度低，但用户重合度很高的情况。
  - 联邦迁移学习：适用于两个场景下用户的特征和用户本身重合度都很低的情况。
- 特征：多方协作、各方平等、数据隐私保护、数据加密。

### 2.2 横向联邦学习

- 集中式模型训练：将用户每天产生的行为数据全部上传至云端服务器，在服务器上的模型进行训练，并更新模型，本地请求云端服务。
- 分布式模型训练：用户数据不出本地，所有模型训练在设备本地进行，训练完毕后，将模型的参数或下降梯度经过加密上传至云端，节后所有上传的参数值进行统一聚合，然后将新结果下发到本地，本地更新一个全新模型。

### 2.3 纵向联邦学习

- 样本对齐：基于加密的用户ID对齐技术，对齐共有用户。
- 标签统一：由其中一侧进行标签的管控。
- 加密训练：引入第三方协作者用来处理数据，分别下发公钥给双方，双方计算各自的下降梯度，再加密上传给协作者，协作者解密后汇总双方结果，得到一个最终的梯度值。
- 训练结束，联合模型更新：直至最终模型收敛训练完毕，双方的模型参数更新完毕，两者节后在一起就是一个联合模型。

### 2.4 实际应用案例

- 金融风控场景：联邦学习让各大金融机构之间联合建模，对用户的资质进行全面、客观的评价，从而降低贷款违约率和资产不良率。
- 广告场景：接入更多互联网企业的数据，既提升点击率，也可以提升广告主的ROI。

## 3 隐私计算

- 多方安全计算问题：在无可信第三方的情况下，多个参与方共同计算一个目标函数，并且保证每一方仅获取自己的计算结果，同时无法通过计算过程中的交互数据推测出其他任意一方的输入数据。
- 隐私计算核心问题：如何让数据更合规、更安全地流通和应用。
- 技术体系：
  - 底层硬件：可信执行环境（TEE）通过在CPU中构建一个安全的区域，保证其内部加载运行的程序和数据在机密性和完整性上得到充分保证。
  - 基础层：多方安全计算
  - 应用层：联合建模、联合查询、联合统计

## 4 边缘计算

- 云计算的基本特点：
  - 数据离开本地，集中在云服务器上统一计算。
  - 网络通信要求很高。
- 边缘计算的定义：在靠近设备或者数据源头的网络边缘侧，通过融合网络、计算、存储、应用核心能力的分布式开放平台，就近提供边缘智能服务。
- 边缘计算的组成部分：
  - 终端节点：各种终端设备，主要收集原始数据并完成上报。
  - 边缘计算节点
  - 网络节点：负责将边缘计算节点处理后的数据传输至云计算节点，供后续统一进行更加复杂的计算。
  - 云计算节点：将数据在云计算节点进行永久性存储。

**云计算与边缘计算对比**

| 比较项目 |    云计算    |          边缘计算          |
| :------: | :----------: | :------------------------: |
| 计算方式 |  集中式计算  |  分布式计算，聚焦实时计算  |
| 处理位置 | 云端服务中心 |  终端设备或者边缘计算节点  |
|  延时性  |      高      |             低             |
| 数据存储 | 存储所有数据 | 只存储和计算相关的有用数据 |
| 部署成本 |      高      |             低             |
| 隐私安全 |      低      |             高             |

