# 第2章 策略产品经理必备机器学习知识

机器学习是一门研究如何让计算机从历史数据中去更好地学习，从而产生一个优秀模型以提升系统某项性能的学科，但实际应用远远不是研究算法这么简单。

## 1 机器学习和AI的关系

- 人工智能包括三大要素：数据、算法和算力。
- 机器学习是实现人工智能的方法论。
- 发展阶段：
  - 弱人工智能：人工智能专注某个方面，在某些方面具备和人一样的能力，但整体相差很远。
  - 强人工智能：媲美人脑，可以像人一样有情感、批判性地思考，能做计划，能理解复杂概念并快速学习。
  - 超人工智能：在智商和情商方面全面超越人类。相当于从三维世界进入了四维世界。

## 2 机器学习全流程

- 问题定义：分类任务（二分类和多分类）、聚类任务、回归任务
- 数据处理：
  - 数据收集：确认本次训练所需要使用的数据，合并成大宽表。
  - 数据清洗：清除脏数据、测试数据、无效数据，统一字段含义。
  - 数据标注：在执行某些任务时，需要通过人工方式进行标注，明确样本标签。
  - 数据切分：对数据进行随机切分，一部分作为训练集，一部分作为测试集。
- 特征工程
- 模型训练：监督学习、无监督学习、半监督学习、强化学习。
- 模型评估：
  - 分类任务：主要关注召回率、精准率和AUC指标。
  - 聚类任务：主要关注聚类纯度、兰德系数。
  - 回归任务：主要关注MSE、RMSE、R-Squared指标。
- 模型应用：将离线效果最好的模型在线上真实环境中进行测试。

## 3 机器学习常见指标

### 3.1 分类模型离线评估指标

- TP：真正例，预测为正样本且真实也为正样本的个数。
- FP：假正例，预测为正样本但真实为负样本的个数。
- FN：假负例，预测为负样本但真实为正样本的个数。
- TN：真负例，预测为负样本且真实也为负样本的个数。
- ACC：准确率，模型整体预测结果的准确性。当样本中正负样本比例严重倾斜时，准确率不具备参考意义。
$$
\text{ACC} = \frac{\text{TP}+ \text{TN}}{\text{TP} + \text{FP} + \text{TN} + \text{FN}}
$$

- R：查全率或召回率，模型能够将数据中所有正样本找到的覆盖率。

$$
\text{R} = \frac{\text{TP}}{\text{TP} + \text{FN}}
$$

- P：查准率或精准率，模型预估的正样本中有多少是真实的正样本。
$$
\text{P} = \frac{\text{TP}}{\text{TP} + \text{FP}}
$$

- $\text{F}_{\beta}$-Score：当$\beta=1$时，均衡考察查全率和查准率的重要性，当$\beta>1$时，更侧重查全率，当$0 < \beta < 1$时，更侧重查准率。

$$
\text{F}_{\beta} = \frac{(1 + \beta^2)RP}{R + \beta^2 P}
$$

- TPR：真正率，模型预测响应的覆盖程度。
$$
\text{TPR} = \frac{\text{TP}}{\text{TP} + \text{FN}}
$$

- FPR：假正率，模型预测响应的虚报程度。
$$
\text{FPR} = \frac{\text{FP}}{\text{FP} + \text{TN}}
$$

### 3.2 回归模型离线评估指标

- MSE：均方误差
$$
\text{MSE} = \frac{1}{n} \sum_{i = 1}^n (y_i - \hat{y}_i)^2
$$

- RMSE：均方根误差
$$
\text{RMSE} = \sqrt {\frac{1}{n} \sum_{i = 1}^n (y_i - \hat{y}_i)^2}
$$

- MAE：平均绝对误差
$$
\text{MAE} = \frac{1}{n} \sum_{i = 1}^n |(y_i - \hat{y}_i)|
$$

- R-Squared
$$
R^2 = 1 - \frac{\displaystyle \sum_{i = 1}^n (y_i - \hat{y}_i)^2}{\displaystyle \sum_{i = 1}^n (\bar{y} - \hat{y}_i)^2}
$$

### 3.3 聚类模型离线评估指标

- CH指数：通过计算簇中各点与簇中心（质心）的距离平方和，度量类内的紧密度。CH指数越大表示各个簇本身越紧密，簇与簇之间越分离，聚类效果越好。
$$
\text{CH} = \frac{\text{分离度}}{\text{紧密度}}
$$

- 聚类纯度：聚类后每个簇里面占比最高的同一个类别的样本数占整个簇样本数的比例。

$$
\text{purity} = (\Omega, C) = \frac{1}{N} \sum_k \max_j |\omega_k \cap c_j|
$$

- 兰德系数
$$
\text{RI} = \frac{\text{TP} + \text{TN}}{\text{TP} + \text{FP} + \text{FN} + \text{TN}}
$$

## 4 工业界常见算法

- 逻辑回归
$$
y = \frac{1}{1 + e^{-w^T x}}
$$

- K近邻算法（KNN）
- 贝叶斯模型
  - 贝叶斯公式：$\displaystyle P(A|B) = P(A) \times \frac{P(B|A)}{P(B)}$
  - 全概率公式：$\displaystyle P(B) = \sum_{i = 1}^n P(B|A_i) \times P(A_i)$
- K聚类算法（K-Means）
- 决策树
- 深度神经网络

